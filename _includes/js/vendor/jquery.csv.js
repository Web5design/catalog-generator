/**
 * jQuery-csv (jQuery Plugin)
 * version: 0.70 (2012-11-04)
 *
 * This document is licensed as free software under the terms of the
 * MIT License: http://www.opensource.org/licenses/mit-license.php
 *
 * Acknowledgements:
 * The original design and influence to implement this library as a jquery
 * plugin is influenced by jquery-json (http://code.google.com/p/jquery-json/).
 * If you're looking to use native JSON.Stringify but want additional backwards
 * compatibility for browsers that don't support it, I highly recommend you
 * check it out.
 *
 * A special thanks goes out to rwk@acm.org for providing a lot of valuable
 * feedback to the project including the core for the new FSM
 * (Finite State Machine) parsers. If you're looking for a stable TSV parser
 * be sure to take a look at jquery-tsv (http://code.google.com/p/jquery-tsv/).

 * For legal purposes I'll include the "NO WARRANTY EXPRESSED OR IMPLIED.
 * USE AT YOUR OWN RISK.". Which, in 'layman's terms' means, by using this
 * library you are accepting responsibility if it breaks your code.
 *
 * Legal jargon aside, I will do my best to provide a useful and stable core
 * that can effectively be built on.
 *
 * Copyrighted 2012 by Evan Plaice.
 */RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(e){"use strict";e.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(e,t){var n=/\./;if(isNaN(e))return e;if(n.test(e))return parseFloat(e);var r=parseInt(e);return isNaN(r)?null:r}},parsers:{parse:function(e,t){function f(){o=0,u="";if(t.start&&t.state.rowNum<t.start){s=[],t.state.rowNum++,t.state.colNum=1;return}if(t.onParseEntry===undefined)i.push(s);else{var e=t.onParseEntry(s,t.state);e!==!1&&i.push(e)}s=[],t.end&&t.state.rowNum>=t.end&&(a=!0),t.state.rowNum++,t.state.colNum=1}function l(){if(t.onParseValue===undefined)s.push(u);else{var e=t.onParseValue(u,t.state);e!==!1&&s.push(e)}u="",o=0,t.state.colNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var i=[],s=[],o=0,u="",a=!1,c=RegExp.escape(n),h=RegExp.escape(r),p=/(D|S|\n|\r|[^DS\r\n]+)/,d=p.source;return d=d.replace(/S/g,c),d=d.replace(/D/g,h),p=RegExp(d,"gm"),e.replace(p,function(e){if(a)return;switch(o){case 0:if(e===n){u+="",l();break}if(e===r){o=1;break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;u+=e,o=3;break;case 1:if(e===r){o=2;break}u+=e,o=1;break;case 2:if(e===r){u+=e,o=1;break}if(e===n){l();break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){l();break}if(e==="\n"){l(),f();break}if(/^\r$/.test(e))break;if(e===r)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),s.length!==0&&(l(),f()),i},splitLines:function(e,t){function a(){s=0;if(t.start&&t.state.rowNum<t.start){o="",t.state.rowNum++;return}if(t.onParseEntry===undefined)i.push(o);else{var e=t.onParseEntry(o,t.state);e!==!1&&i.push(e)}o="",t.end&&t.state.rowNum>=t.end&&(u=!0),t.state.rowNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1);var i=[],s=0,o="",u=!1,f=RegExp.escape(n),l=RegExp.escape(r),c=/(D|S|\n|\r|[^DS\r\n]+)/,h=c.source;return h=h.replace(/S/g,f),h=h.replace(/D/g,l),c=RegExp(h,"gm"),e.replace(c,function(e){if(u)return;switch(s){case 0:if(e===n){o+=e,s=0;break}if(e===r){o+=e,s=1;break}if(e==="\n"){a();break}if(/^\r$/.test(e))break;o+=e,s=3;break;case 1:if(e===r){o+=e,s=2;break}o+=e,s=1;break;case 2:var i=o.substr(o.length-1);if(e===r&&i===r){o+=e,s=1;break}if(e===n){o+=e,s=0;break}if(e==="\n"){a();break}if(e==="\r")break;throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");case 3:if(e===n){o+=e,s=0;break}if(e==="\n"){a();break}if(e==="\r")break;if(e===r)throw new Error("CSVDataError: Illegal quote [Row:"+t.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+t.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+t.state.rowNum+"]")}}),o!==""&&a(),i},parseEntry:function(e,t){function u(){if(t.onParseValue===undefined)i.push(o);else{var e=t.onParseValue(o,t.state);e!==!1&&i.push(e)}o="",s=0,t.state.colNum++}var n=t.separator,r=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var i=[],s=0,o="";if(!t.match){var a=RegExp.escape(n),f=RegExp.escape(r),l=/(D|S|\n|\r|[^DS\r\n]+)/,c=l.source;c=c.replace(/S/g,a),c=c.replace(/D/g,f),t.match=RegExp(c,"gm")}return e.replace(t.match,function(e){switch(s){case 0:if(e===n){o+="",u();break}if(e===r){s=1;break}if(e==="\n"||e==="\r")break;o+=e,s=3;break;case 1:if(e===r){s=2;break}o+=e,s=1;break;case 2:if(e===r){o+=e,s=1;break}if(e===n){u();break}if(e==="\n"||e==="\r")break;throw new Error("CSVDataError: Illegal State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");case 3:if(e===n){u();break}if(e==="\n"||e==="\r")break;if(e===r)throw new Error("CSVDataError: Illegal Quote [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+t.state.rowNum+"][Col:"+t.state.colNum+"]")}}),u(),i}},toArray:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter;var s=n.state!==undefined?n.state:{},n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,state:s},o=e.csv.parsers.parseEntry(t,n);if(!i.callback)return o;i.callback("",o)},toArrays:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter;var s=[],n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1}};s=e.csv.parsers.parse(t,n);if(!i.callback)return s;i.callback("",s)},toObjects:function(t,n,r){var n=n!==undefined?n:{},i={};i.callback=r!==undefined&&typeof r=="function"?r:!1,i.separator="separator"in n?n.separator:e.csv.defaults.separator,i.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,i.headers="headers"in n?n.headers:e.csv.defaults.headers,n.start="start"in n?n.start:1,i.headers&&n.start++,n.end&&i.headers&&n.end++;var s=[],o=[],n={delimiter:i.delimiter,separator:i.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,start:n.start,end:n.end,state:{rowNum:1,colNum:1},match:!1},u={delimiter:i.delimiter,separator:i.separator,start:1,end:1,state:{rowNum:1,colNum:1}},a=e.csv.parsers.splitLines(t,u),f=e.csv.toArray(a[0],n),s=e.csv.parsers.splitLines(t,n);n.state.colNum=1,f?n.state.rowNum=2:n.state.rowNum=1;for(var l=0,c=s.length;l<c;l++){var h=e.csv.toArray(s[l],n),p={};for(var d in f)p[f[d]]=h[d];o.push(p),n.state.rowNum++}if(!i.callback)return o;i.callback("",o)},fromArrays:function(t,n,r){var n=n!==undefined?n:{},s={};s.callback=r!==undefined&&typeof r=="function"?r:!1,s.separator="separator"in n?n.separator:e.csv.defaults.separator,s.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,s.escaper="escaper"in n?n.escaper:e.csv.defaults.escaper,s.experimental="experimental"in n?n.experimental:!1;if(!s.experimental)throw new Error("not implemented");var o=[];for(i in t)o.push(t[i]);if(!s.callback)return o;s.callback("",o)},fromObjects2CSV:function(t,n,r){var n=n!==undefined?n:{},s={};s.callback=r!==undefined&&typeof r=="function"?r:!1,s.separator="separator"in n?n.separator:e.csv.defaults.separator,s.delimiter="delimiter"in n?n.delimiter:e.csv.defaults.delimiter,s.experimental="experimental"in n?n.experimental:!1;if(!s.experimental)throw new Error("not implemented");var o=[];for(i in t)o.push(arrays[i]);if(!s.callback)return o;s.callback("",o)}},e.csvEntry2Array=e.csv.toArray,e.csv2Array=e.csv.toArrays,e.csv2Dictionary=e.csv.toObjects}(jQuery);